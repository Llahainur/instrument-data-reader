<h1>instrument-data-reader</h1>
<h2>Курсовой проект по предмету ИТ. Программа предназначена для распознавания показаний стрелочных приборов по фотографии</h2>
<h2>Постановка задачи</h2>
На данный момент, в открытых источниках решения этой проблемы не существует, однако, есть алгоритмы, позволяющие распознавать фрагменты изображений по некоторым признакам. Чтобы распознать показания прибора, необходимо найти угол наклона его стрелочки, затем, в зависимости от особенностей модели прибора можно создать формулу, описывающую зависимость его показаний от угла наклона стрелки. Таким образом, проблема сводится к поиску этого угла. Я не занимался созданием формул, поскольку, они полностью зависят от модели прибора.

![p5 контуры](https://user-images.githubusercontent.com/94802067/177036179-6441440a-9391-45b1-ac71-adf9c5ca19c1.JPG)

Мной был использован язык программирования Python версии 3.6, виртуальное окружение pip и Pycharm IDE. Использовались библиотеки питон opencv2, numpy, math, os, tkinter последих версий. 

Было разработано 2 метода решения задачи, один показал крайне низкую точность срабатывания, тем не менее, его я тоже приведу в работе.
Метод поиска по цвету
Данный метод заключается в поиске на изображении фигуры (стрелочки) определенного цвета, отличного от цвета корпуса. Т.к на большинстве приборов они имеют красный цвет, я использовал его. Алгоритм:
<ol>
<li> 	 Импорт изображения и преобразование его в цветовую модель HSV (opencv cvtColor)
<li> 	Применение цветового фильтра по нужному цвету (opencv threshold)
<li> 	Поиск контуров на полученном изображении (opencv findContours)
<li> 	Поиск прямоугольных контуров (opencv minArearect)
<li> 	Очистка помех, стрелочка – самый большой 
<li> 	Поиск угла наклона большей стороны прямоугольника
<li> 	Если прямоугольник расположен выше центра фотографии, то угол (0, 180), если ниже, (180, 360). Т.к Принадлежность к верхней или нижней полуплоскости определяется дополнительно, если нижняя, то к углу прибавляется 180 гр.
<li> 	Вывод угла
</ol>
Минусом метода является необходимость наличия стрелочки цвета отличающегося от цвета корпуса.
В работе представлен функцией sq_method
Метод моментов
Этот метод имеет очень низкую точность и в реальном проекте использоваться сможет только после доработки. Я обзорно опишу его алгоритм.
<ol>
<li> 	Импорт изображения, его преобразование в черно-белое, размытие методом Гаусса и удаление помех. Сложно подобрать нужные коэффициенты, такие, чтобы на изображении остался виден корпус и стрелочка прибора и были удалены все лишние детали. (opencv GaussianBlur, threshold) в работе – функции get_ready и get_ready2
<li> 	Изображение обрезается, так, чтобы остался только центр прибора с стрелкой, а корпус был бы не виден.
<li> 	Вычисляются цветовые моменты (opencv moments)
<li> 	Из них можно найти тангенс угла наклона стрелочки и, соответственно, сам угол.
</ol>
На практике, метод нахождения угла из цветовых моментов имеет низкую точность, недостаточную для работы с приборами, и коэффициенты гаусса подбирать – задача сложная, приходится выполнять её вручную, сто нивелирует смысл программы. 
